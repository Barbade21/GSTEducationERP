 
@{
    ViewBag.Title = "StudentFeeDetailsViewGJ";
    Layout = "~/Views/Shared/Student_LayoutERP.cshtml";

}

<html>
<head>
    <link rel="stylesheet" href="~/Content/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
    <link href="~/Content/Trainer/css/CourseContent.css" rel="stylesheet" />

    <style>
        .dataTables_wrapper .btn-secondary {
            color: #235;
            background-color: transparent !important;
            border-color: transparent;
            font-size: x-large;
            margin: 0px !important;
        }

        h2 {
            padding-top: 10px;
            margin-bottom: 10px;
            font-family: Verdana;
            font-weight: bold;
            font-size: medium;
            color: #3b5999;
        }

        .card-primary.card-outline-tabs > .card-header a.active {
            border-top: 3px solid #33CCCC;
        }

        a {
            color: #33CCCC;
        }

        .card.card-outline-tabs .card-header a:hover {
            color: #33CCCC;
        }

        .card-primary.card-outline-tabs > .card-header a.active, .card-primary.card-outline-tabs > .card-header a.active:hover {
            border-top: 3px solid #33CCCC;
        }

        .card-body {
            font-family: Calibri !important;
            padding-bottom: 0px !important;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        th {
            background-color: #3b5999;
            color: white;
            text-align: center !important;
        }

        td {
            text-align: center;
            color: black !important;
        }

        .table td {
            padding: 0px 0px 0px 0px !important;
            font-size: 14px !important;
        }

        .table th {
            padding: 5px 5px 4px 10px !important;
            font-size: 14px !important;
        }

        table.dataTable > thead .sorting:after, table.dataTable > thead .sorting:before {
            font-size: xx-small !important;
        }

        div.dataTables_wrapper div.dataTables_filter {
            margin-top: -10px !important;
        }

        div.dt-buttons {
            margin-top: -20px !important;
        }

        .btn-group > .btn:not(:last-child):not(.dropdown-toggle), .btn-group > .btn-group:not(:last-child) > .btn {
            padding-left: 5px !important;
            padding-right: 5px !important;
        }

        div.dataTables_wrapper div.dataTables_filter label {
            font-size: small !important;
        }

        div.dataTables_wrapper div.dataTables_filter input {
            height: 30px !important;
        }

        div.dataTables_wrapper div.dataTables_info {
            padding: 0px !important;
            font-size: small !important;
        }

        div.dataTables_wrapper div.dataTables_paginate ul.pagination {
            margin-top: 0px !important;
        }

        div.dataTables_wrapper div.dataTables_paginate {
            font-size: small !important;
        }

        .wrapper {
            width: 100%;
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: #f9f9f9;
        }

        .table-bordered {
            border: 1px solid #dee2e6;
            border-collapse: collapse;
        }

            .table-bordered th,
            .table-bordered td {
                border: 1px solid #dee2e6;
                padding: 8px;
            }
    </style>
@*</head>
<head>*@
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css">
    <script src="~/Content/plugins/jquery/jquery.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/bootstrap/js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <script src="~/Content/Admin/js/Icon.js"></script>



    <script src="~/Content/plugins/jquery/jquery.min.js"></script>



    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="~/Content/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
    <link href="~/Content/Trainer/css/CourseContent.css" rel="stylesheet" />

    <link rel="stylesheet" href="~/Content/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">




    <style>

        /* Adjust modal dialog width and height */
        #SectionModal .modal-dialog {
            max-width: none;
            width: auto;
            display: table;
        }

            /* Center the modal horizontally and vertically */
            #SectionModal .modal-dialog .modal-content {
                display: table-cell;
                vertical-align: middle;
            }

        /* Style the card columns for proper alignment */
        #SectionModal .modal-body .row {
            display: flex;
            flex-wrap: wrap;
        }

        #SectionModal .modal-body .col-md-4,
        #SectionModal .modal-body .col-md-6 {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Ensure proper card styling */
        #SectionModal .card {
            width: 100%;
            height: 100%;
        }




        .dataTables_wrapper .btn-secondary {
            color: #235;
            background-color: transparent !important;
            border-color: transparent;
            font-size: x-large;
            margin: 0px !important;
            border: 2px solid black;
        }

        h2.custom-style {
            padding-right: 200px;
            background-color: #3b5999;
            color: white; /* Optional: change text color for better contrast */
            border-radius: 15px; /* Adjust the value for more or less curve */
            padding: 10px; /* Optional: add padding inside the h2 element */
        }

        .stats-box {
            background: linear-gradient(135deg, #3b5999, #8b9dc3);

            /*padding: 10px;*/ /* Add padding if needed */
            /*border-radius: 10px;*/ /* Optional: for rounded corners */
        }


        .card-primary.card-outline-tabs > .card-header a.active {
            border-top: 3px solid #33CCCC;
        }

        a {
            color: #33CCCC;
        }

        .card.card-outline-tabs .card-header a:hover {
            color: #33CCCC;
        }

        .card-primary.card-outline-tabs > .card-header a.active, .card-primary.card-outline-tabs > .card-header a.active:hover {
            border-top: 3px solid #33CCCC;
        }

        .card-body {
            font-family: Calibri !important;
            padding-bottom: 0px !important;
        }

        .cardlabelsGJ:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .highlight {
            background-color: yellow;
        }



        div.dt-buttons {
            margin-top: -20px !important;
        }

        .btn-group > .btn:not(:last-child):not(.dropdown-toggle), .btn-group > .btn-group:not(:last-child) > .btn {
            padding-left: 5px !important;
            padding-right: 5px !important;
        }      
 .align{
     left:20vw !important;
 }
    </style>

</head>
<body>
    <br>
    <h2 class="custom-style">
        <img src="~/Content/StudentTemplate/images/scholarship.png" style = width=" 50" height="50">
        Fees Details
        <span style="margin-left: 66%;">
            <img src="~/Content/StudentTemplate/images/student.png"  style= width=" 50" height="50">

        </span>
        Batch Name :
        <span class="count" id="BatchName">@Html.ViewBag.BatchName1G</span>
    </h2>
    <br />




    <div class="container">
        <div class="row ">
            <!-- Course Fees -->
            <div class="col-xl-3 col-lg-6 col-md-5 col-12">
                <div class="card mb-3 cardlabelsGJ">
                    <div class="d-flex flex-column justify-content-between h-100">
                        <div class="stats-box" style="width:19vw">
                            <h5 class="mb-2 fw-normal">
                                <img src="~/Content/StudentTemplate/images/spend.png" / style= width=" 50" height="50"> Course Fees
                            </h5>
                        </div>
                        <div class="p-3">
                            <div class="badge rounded-pill mb-3 fs-3 bg-primary-subtle text-primary">
                                <span class="count" id="CourseFees">@Html.ViewBag.CourseFee1 ₹ </span>
                            </div>
                            <span class="badge bg-primary-subtle text-primary small"> Fees in ₹ </span>
                            @*<a href="javascript:void(0)" class="text-primary ms-2">Course Fees</a>*@
                        </div>
                    </div>
                </div>
            </div>
            <!-- Fees Discount Count -->
            <div class="col-xl-3 col-lg-6 col-md-5 col-12">
                <div class="card mb-3 cardlabelsGJ">
                    <div class="d-flex flex-column justify-content-between h-100">
                        <div class="stats-box" style="width:19vw">
                            <h5 class="mb-2 fw-normal">
                                <img src="~/Content/StudentTemplate/images/discount.png" style= width=" 50" height="50">
                                Discount
                            </h5>
                        </div>
                        <div class="p-2">
                            <div class="badge rounded-pill mb-3 fs-3 bg-primary-subtle text-primary">
                                <span class="count" id="DiscountCount">@Html.ViewBag.Discount1 %</span>
                            </div>
                            <span class="badge bg-primary-subtle text-primary small">@Html.ViewBag.DiscountMessage</span>
                            <br>
                            <br>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Total Fees -->
            <div class="col-xl-3 col-lg-6 col-md-5 col-12">
                <div class="card mb-3 cardlabelsGJ">
                    <div class="d-flex flex-column justify-content-between h-100">
                        <div class="stats-box" style="width:19vw">
                            <h5 class="mb-2 fw-normal">
                                <img src="~/Content/StudentTemplate/images/money.png" style= width=" 50" height="50"> Total Fees
                            </h5>
                        </div>
                        <div class="p-3">
                            <div class="badge rounded-pill mb-3 fs-3 bg-primary-subtle text-primary">
                                <span class="count" id="TotalFeesCount">@Html.ViewBag.TotalFeesCount1G ₹ </span>
                            </div>

                            <span class="badge bg-primary-subtle text-primary small">Fees After Discount </span>
                            @*<a href="javascript:void(0)" class="text-primary ms-2">Course Fees</a>*@
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paid Fees -->
            <div class="col-xl-3 col-lg-6 col-md-4 col-12">
                <div class="card mb-3 cardlabelsGJ">
                    <div class="d-flex flex-column justify-content-between h-100">
                        <div class="stats-box" style="width:19vw">
                            <h5 class="mb-2 fw-normal">
                                @*<i class="bi bi-basket fs-1"></i>*@
                                <img src="~/Content/StudentTemplate/images/charge.png" style= width=" 50" height="50"> Paid Fees
                            </h5>
                            @* <i class="bi bi-basket fs-1"></i>*@
                        </div>
                        <div class="p-3">
                            <div class="badge rounded-pill mb-3 fs-3 bg-primary-subtle text-primary">
                                <span class="count" id="PaidFeesCount">@Html.ViewBag.PaidFeesCount1G ₹  </span>
                            </div>

                            <span class="badge bg-primary-subtle text-primary small"> Till Date </span>
                            @*<a href="javascript:void(0)" class="text-primary ms-2">Course Fees</a>*@
                        </div>
                    </div>
                </div>
            </div>



            <!-- Remaining Fees -->
            <div class="col-xl-3 col-lg-6 col-md-4 col-12" style="margin-left:150px;">
                <div class="card mb-3 cardlabelsGJ">
                    <div class="d-flex flex-column justify-content-between h-100">
                        <div class="stats-box" style="width:19vw">
                            <h5 class="mb-2 fw-normal">
                                <img src="~/Content/StudentTemplate/images/fees.png" style= width=" 50" height="50"> Remaining Fees
                            </h5>
                        </div>
                        &nbsp; &nbsp;
                        <div class="d-flex align-items-center">
                            &nbsp; &nbsp;
                            <div class="badge rounded-pill mb-3 fs-3 bg-primary-subtle text-primary">
                                <span class="count" id="RemainingFeesCount">@Html.ViewBag.RemainingFeesCount1G ₹ </span>
                            </div>

                            <span class="badge bg-primary-subtle text-primary small">Pending Fees </span>
                            @*<a href="javascript:void(0)" class="text-primary ms-2">Course Fees</a>*@
                        </div>
                    </div>
                </div>
            </div>


            <!-- Installment date & Amount Fees2 -->
            <!-- Installment date & Amount Fees2 -->
            <div class="col-xl-3 col-lg-6 col-md-4 col-12">
                <div class="card mb-3 cardlabelsGJ" style="max-height: 10vw; overflow-y: auto; overflow-x: hidden;">
                    @{
                        // Retrieve formatted dates as strings from ViewBag
                        List<string> installmentDates = ViewBag.InstallmentDates as List<string>;
                        List<string> installmentAmounts = ViewBag.InstallmentAmounts as List<string>;
                        DateTime maxDateFromModels1 = DateTime.MinValue;

                        // Get the maximum date from Model.lstfeesDetailsGJ
                        if (Model.lstfeesDetailsGJ != null && Model.lstfeesDetailsGJ.Count > 0)
                        {
                            maxDateFromModels1 = Model.lstfeesDetailsGJ.Max(item => item.InstallmentDate);
                        }
                    }
                    <!-- Sticky Position -->
                    <div class="stats-box" style="width: 16vw; position: sticky; top: 0;">
                        <h5 class="mb-2 fw-normal">
                            <img src="~/Content/StudentTemplate/images/annuities.png" style="width: 50px; height: 50px;">
                           Installment Dates
                        </h5>
                    </div>

                    <br />

                    @if (!string.IsNullOrEmpty(ViewBag.Message))
                    {
                        <p style="margin-left:30px;"><b>@ViewBag.Message</b></p>
                    }
                    else if (installmentDates != null && installmentDates.Count > 0 && installmentAmounts != null)
                    {
                        <ul class="installment-list">
                            @for (int i = 0; i < installmentDates.Count; i++)
                            {
                                // Parse string dates back to DateTime to compare with maxDateFromModels1
                                DateTime parsedDate = DateTime.Parse(installmentDates[i]);
                                bool isNextDate = parsedDate > maxDateFromModels1;
                                <li style="color: @(isNextDate ? "red" : "green"); font-weight: bold;">
                                    @installmentDates[i] - Amount: @installmentAmounts[i]
                                </li>
                            }
                        </ul>
                    }
                    else
                    {
                        <p style="margin-left:30px;"><b>No installment dates available.</b></p>
                    }
                </div>
            </div>

            <!-- Other Fees -->
            <div class="col-xl-3 col-lg-6 col-md-4 col-12">
                @*<a href="#" class="otherfee" data-url="@Url.Action("popup", "Student", new {})" data-toggle="modal" data-target="#SectionModal">*@

                <a href="#" class="otherfee" data-url="@Url.Action("popup", "Student", new {})" data-toggle="modal" data-target="#SectionModal">
                    <div class="card mb-3 cardlabelsGJ">
                        <div class="d-flex flex-column justify-content-between h-100">
                            <div class="stats-box" style="width:19vw">
                                <h5 class="mb-1 fw-normal">

                                    <img src="~/Content/StudentTemplate/images/transaction.png" width="50" height="50"> Other Fees
                                </h5>

                            </div>

                            <div class="p-3">
                                <div class="badge rounded-pill mb-3 fs-3 bg-primary-subtle text-primary">
                                    <button type="button" class="otherfee" data-id="@Model.CandidateCode" data-url="@Url.Action("popup", "Student", new { candidateCode = Model.CandidateCode })" title="View Other Fees" />
                                    <img src="~/Content/StudentTemplate/icon/review.gif" width="30" height="30" />
                                </div>
                            </div>
                        </div>
                    </div>
                </a>

            </div>

        </div>
    </div>






    @model GSTEducationERPLibrary.Student.Student

    
<div class="card" style="padding:10px">
    <h2>Course Fees</h2>
    <table id="example1" class="wrapper table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.SerialNo)
                </th>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.ReciptCode)
                </th>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.TransactionNOCount)
                </th>

                <th scope="col">
                    @Html.DisplayNameFor(model => model.FeesType)
                </th>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.InstallmentDate)
                </th>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.CreditAmount)
                </th>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.PaymentMode)
                </th>
                <th scope="col">
                    @Html.DisplayNameFor(model => model.TransactionId)
                </th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.lstfeesDetailsGJ != null && Model.lstfeesDetailsGJ.Any())
            {
                foreach (var item in Model.lstfeesDetailsGJ)
                {

                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.SerialNo)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.ReciptCode)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.TransactionNOCount)
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.FeesType)
                        </td>
                        <td>
                            @item.InstallmentDate.ToString("dd-MMMM-yyyy")

                            @*@Html.DisplayFor(modelItem => item.InstallmentDate)*@
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.CreditAmount) ₹
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.PaymentMode)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.TransactionId)
                        </td>
                        <td>
                            <a href="@Url.Action("ShowFeeReciptGJ", "Student", new { ReciptCode = item.ReciptCode })" class="View" data-id="@item.ReciptCode" title="View Receipt">

                                <img src="~/Content/StudentTemplate/icon/review.gif" width="25" height="25" />
                            </a>
                        </td>
                    </tr>
                }

            }
            else
            {
                <tr>
                    <td colspan="8">No Fees History</td>
                </tr>
            }
        </tbody>
    </table>

</div>

    <!-- Modal Structure -->
    <div class="modal fade" id="detailsModal" tabindex="-1" role="dialog" aria-labelledby="detailsModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <script src="~/Content/plugins/jquery/jquery.min.js" type="text/javascript"></script>
    <script src="~/Content/Trainer/js/CourseContent.js"></script>
    <script src="~/Content/Admin/js/Icon.js"></script>
    <script src="~/Content/plugins/bootstrap/js/bootstrap.bundle.min.js" type="text/javascript"></script>
    @*<script src="~/Content/plugins/datatables/jquery.dataTables.min.js" type="text/javascript"></script>*@
    <script src="~/Content/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-responsive/js/dataTables.responsive.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-responsive/js/responsive.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-buttons/js/dataTables.buttons.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/jszip/jszip.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/pdfmake/pdfmake.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/pdfmake/vfs_fonts.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.html5.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.print.min.js" type="text/javascript"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.colVis.min.js" type="text/javascript"></script>
    <script type="text/javascript">
     $(document).ready(function () {
         $.noConflict();
         var table = $('#example1').DataTable({
             "responsive": true, "lengthChange": false, "autoWidth": true,
             
             "responsive": true,
             "lengthChange": false,
             "autoWidth": true
         }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');
         $('#custom-tabs-four-tab').on('click', '.nav-link', function (e) {
         e.preventDefault();
         var tabContentUrl = $(this).attr('href');
         loadTabContent(tabContentUrl);
     });
         var defaultTabUr
         l = '@Url.Action("StudentFeeDetailsViewGJ", "Student")';
     loadTabContent(defaultTabUrl);
     });

    </script>



    <!--Popup code start -->

    <style>
        .blur-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8); /* Adjust opacity and color as needed */
            backdrop-filter: blur(10px); /* Adjust the blur intensity as needed */
            z-index: 1040; /* Ensure it is behind the modal which has z-index 1050 by default */
            display: none; /* Initially hidden */
        }
    </style>

    <!-- Modal -->
    <div id="blurOverlay" class="blur-overlay"></div>

    <div id="SectionModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1>Other Fees</h1>
                    <div>
                        <button type="button" class="close align" data-dismiss="modal" aria-label="Close" style="color: #ff0000; background-color: white; border: white; left: 20vw !important; margin-left: 1280px; max-block-size:50px;">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>

                </div>
                <div class="modal-body">
                    <!-- Modal content will be loaded dynamically via AJAX -->
                </div>
            </div>
        </div>
    </div>

</body>
</html>

<script>
    $(document).ready(function () {
        $('.otherfee').click(function () {
            var candidatecode = $(this).data('id');
            var url = $(this).data('url');

            // Check if the URL is not empty
            if (url) {
                $.ajax({
                    url: url,
                    type: 'GET',
                    data: { Candidatecode: candidatecode },
                    success: function (data) {
                        $('#SectionModal .modal-body').html(data);
                        $('#SectionModal').modal('show');
                    }
                });
            } else {
                console.error("URL is not defined");
            }
        });

        // Show the blur overlay when the modal is shown
        $('#SectionModal').on('show.bs.modal', function () {
            $('#blurOverlay').show();
        });

        // Hide the blur overlay when the modal is hidden
        $('#SectionModal').on('hidden.bs.modal', function () {
            $('#blurOverlay').hide();
        });
    });

    $(document).ready(function () {
        $('.Edit').on('click', function (e) {
            e.preventDefault();
            var url = $(this).data('url');
            // Load the content into the modal
            $('#detailsModal .modal-content').load(url);
            $('#detailsModal').modal('show');
        });
    });
</script>
